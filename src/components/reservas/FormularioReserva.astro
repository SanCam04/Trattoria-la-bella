---
// ReservaForm.astro
import { useState } from 'react';
const dias = ['DOM', 'LUN', 'MAR', 'MIÉ', 'JUE', 'VIE', 'SÁB'];
const horas = [
  '08:00 am', '09:00 am', '10:00 am', '11:00 am',
  '12:00 pm', '01:00 pm', '02:00 pm', '03:00 pm',
  '04:00 pm', '05:00 pm'
];
---
<section class="bg-white py-10 px-6 font-serif">
  <div class="max-w-6xl mx-auto">
    <h2 class="text-4xl text-center text-[#4e563f] font-light mb-12">Haz tu Reserva</h2>

    <div id="reserva-container" class="grid grid-cols-1 md:grid-cols-3 gap-8 text-[#4e563f]">
      <!-- Invitados -->
      <div class="bg-[#f6f6f6] p-6 rounded-xl shadow text-center">
        <h3 class="text-xl font-light mb-3">Elige</h3>
        <p class="text-sm text-gray-500 mb-4">Número de personas</p>
        <div class="flex justify-center items-center gap-4">
          <button id="decrement" class="w-10 h-10 border border-[#4e563f] rounded-full hover:bg-[#e9d8a6] hover:text-black transition">-</button>
          <span id="invitados" class="text-xl">1</span>
          <button id="increment" class="w-10 h-10 border border-[#4e563f] rounded-full hover:bg-[#e9d8a6] hover:text-black transition">+</button>
        </div>
        <p class="text-xs text-gray-400 mt-4">¿Evento? Contáctanos</p>
      </div>

      <!-- Calendario -->
      <div class="bg-[#f6f6f6] p-6 rounded-xl shadow text-center">
        <h3 class="text-xl font-light mb-3">Fecha</h3>
        <div class="mb-4 flex items-center justify-between">
          <button id="prevMonth" class="text-sm text-gray-500 hover:text-[#4e563f]">&larr; Anterior</button>
          <span id="calendarTitle" class="text-sm font-medium text-[#4e563f]">Julio 2025</span>
          <button id="nextMonth" class="text-sm text-gray-500 hover:text-[#4e563f]">Siguiente &rarr;</button>
        </div>

        <!-- Encabezados: días de la semana -->
        <div class="grid grid-cols-7 gap-2 text-sm mb-2">
          <span class="text-gray-600 font-medium">DOM</span>
          <span class="text-gray-600 font-medium">LUN</span>
          <span class="text-gray-600 font-medium">MAR</span>
          <span class="text-gray-600 font-medium">MIÉ</span>
          <span class="text-gray-600 font-medium">JUE</span>
          <span class="text-gray-600 font-medium">VIE</span>
          <span class="text-gray-600 font-medium">SÁB</span>
        </div>

        <!-- Días renderizados por JavaScript -->
        <div id="calendarDays" class="grid grid-cols-7 gap-2 text-sm">
          <!-- Aquí se insertan los días por JS -->
        </div>
      </div>
      


      <!-- Hora -->
      <div class="bg-[#f6f6f6] p-6 rounded-xl shadow text-center">
        <h3 class="text-xl font-light mb-3">Hora</h3>
        <p class="text-sm text-gray-500 mb-4">Selecciona una hora disponible</p>
        <div id="horasContainer" class="flex flex-wrap gap-2 justify-center">
          {horas.map(hora => (
            <button class="bg-white border border-[#ccc] text-[#4e563f] px-4 py-2 rounded-full hover:bg-[#e9d8a6] hover:text-black transition">
              {hora}
            </button>
          ))}
        </div>
      </div>
    </div>

    <!-- Confirmar -->
    <div class="text-center mt-12">
      <button class="bg-[#e9d8a6] text-black px-10 py-4 rounded-full text-lg hover:bg-[#4e563f] hover:text-white transition shadow-md">
        Confirmar Reserva
      </button>
    </div>
  </div>

  <!-- Script -->
  <script type="module">
    const invitadosEl = document.getElementById('invitados');
    const incrementBtn = document.getElementById('increment');
    const decrementBtn = document.getElementById('decrement');
    let invitados = 1;

    incrementBtn.addEventListener('click', () => {
      invitados++;
      invitadosEl.textContent = invitados;
    });

    decrementBtn.addEventListener('click', () => {
      if (invitados > 1) {
        invitados--;
        invitadosEl.textContent = invitados;
      }
    });

    const calendarDays = document.getElementById('calendarDays');
    const calendarTitle = document.getElementById('calendarTitle');
    const prevMonth = document.getElementById('prevMonth');
    const nextMonth = document.getElementById('nextMonth');

    let date = new Date();
    let selectedDay = null;

    const renderCalendar = () => {
      const month = date.getMonth();
      const year = date.getFullYear();
      const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
      calendarTitle.textContent = `${monthNames[month]} ${year}`;

      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();

      calendarDays.innerHTML = '';
      dias.forEach(d => {
        const span = document.createElement('span');
        span.textContent = d;
        span.className = 'text-gray-600 font-medium';
        calendarDays.appendChild(span);
      });

      for (let i = 0; i < firstDay; i++) {
        const empty = document.createElement('div');
        calendarDays.appendChild(empty);
      }

      for (let i = 1; i <= daysInMonth; i++) {
        const btn = document.createElement('button');
        btn.textContent = i;
        btn.className = 'hover:bg-[#e9d8a6] hover:text-black transition p-2 rounded';
        btn.addEventListener('click', () => {
          if (selectedDay) selectedDay.classList.remove('bg-[#e9d8a6]', 'text-black');
          btn.classList.add('bg-[#e9d8a6]', 'text-black');
          selectedDay = btn;
        });
        calendarDays.appendChild(btn);
      }
    };

    renderCalendar();
    nextMonth.addEventListener('click', () => {
      date.setMonth(date.getMonth() + 1);
      renderCalendar();
    });
    prevMonth.addEventListener('click', () => {
      date.setMonth(date.getMonth() - 1);
      renderCalendar();
    });
  </script>
</section>
